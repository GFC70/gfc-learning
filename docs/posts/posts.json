[
  {
    "path": "posts/2022-08-14-2022-08-14-pq-zoom/",
    "title": "Zooming",
    "description": "Zooming the Power Query Editor Window",
    "author": [
      {
        "name": "Graham Cox",
        "url": {}
      }
    ],
    "date": "2022-08-14",
    "categories": [
      "Excel",
      "Power Query",
      "Tips and Tricks"
    ],
    "contents": "\r\nA tip that is often forgotten about is how to zoom in and out when\r\nusing the Power Query Editor. The text showing the data table can appear\r\nsmall to those with visual difficulties. Even for those without\r\ndifficulties, the size of the text can prove problematic at times.\r\nTo increase the size of the text shown in the editor window, use the\r\nkey combinations of\r\nCTRL SHIFT + to zoom in\r\nCTRL SHIFT - to zoom out\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-08-14-2022-08-14-pq-zoom/./zoom.gif",
    "last_modified": "2022-08-14T16:19:56+01:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to GFC Learning",
    "description": "Welcome to my blog, GFC Learning.",
    "author": [
      {
        "name": "Graham Cox",
        "url": {}
      }
    ],
    "date": "2022-08-14",
    "categories": [
      "Welcome",
      "Excel",
      "Power Query",
      "Power Pivot",
      "DAX",
      "VBA",
      "R",
      "Tidyverse",
      "ggplot"
    ],
    "contents": "\r\nExcel question?\r\nProblems with Power Query?\r\nHere I will try to answer some of the more obscure questions you may\r\nhave about using MS Excel and Power Query, PowerPivot, DAX and using the\r\nExcel Data Model and throw some Visual Basic for Applications (VBA) into\r\nthe mix.\r\n\r\n\r\n\r\nI have also recently been learning the programming language\r\nR. There will also be posts using R showing\r\nhow I have been using it for data transformations and data\r\nvisulisations.\r\n\r\nThis website was built completely in R using the distill\r\npackage. Distill is a publication format for scientific and technical\r\nwriting, native to the web.\r\nLearn more about using Distill for R Markdown at https://rstudio.github.io/distill.\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/welcome/./logo.jpg",
    "last_modified": "2022-08-14T16:17:40+01:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-08-15-how-to-parameterise/",
    "title": "How to parameterise",
    "description": "There are many ways to use parameters in Power Query. Here's my favourite method",
    "author": [
      {
        "name": "Graham Cox",
        "url": {}
      }
    ],
    "date": "2022-08-15",
    "categories": [
      "Excel",
      "Power Query",
      "Tips and Tricks"
    ],
    "contents": "\r\n\r\nContents\r\nThe Problem\r\nThe Solution\r\nTL;DR\r\nCreating a Named Range\r\nExtracting the Named Range\r\nvalue\r\nCreate the Power Query\r\nParameter\r\nUsing\r\nthe Parameter\r\n\r\nConclusion\r\n\r\nThe Problem\r\nWhen I first started using Power Query, in one of its very early\r\nversions, file paths to data sources were often hard-coded into each\r\nquery. This would cause issues if the workbook was sent to another user\r\nand the data source was in a folder on my file structure, obviously, the\r\nother user would not have access to my folders!\r\nThe method of using filenames then changed to using a table on a\r\nworksheet, often named Parameters that would list all the\r\nfile paths for all data sources used by Power Query. This method worked\r\nfine until one monster of a workbook was developed. With 17 or so data\r\nsources from a variety of locations, both shared network folders and\r\nSharePoint Document Libraries, the process began to get slower and\r\nslower.\r\nTo extract a file path and name from the Parameters\r\nworksheet would take an age to load in the Power Query Editor window\r\njust to make a change to the query or to refresh it when in the editor\r\nwindow.\r\nA new method was needed.\r\nThe Solution\r\nI had used the New Parameter method from the Power Query\r\nEditor window to add a value to an item, but others using the workbook\r\nare not always confident in using the editor. The solution was to use\r\nExcel Named Ranges and call them in one line of M code.\r\nTL;DR\r\nCreate a new blank query\r\nRename the query to the required name\r\nOpen the Advanced Editor\r\nRemove the M code shown\r\nPaste in the line below, replacing the Data_Path value\r\nto the name of your named range\r\nExcel.CurrentWorkbook(){[Name=\"Data_Path\"]}[Content]{0}[Column1] meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=false]\r\nClick OK\r\nCreating a Named Range\r\nA named range in Excel can be a single cell or any number of cells\r\nthat have a name assigned to them. Named ranges can be accessed from the\r\ndrop down box to the left of the formula bar.\r\nNamed Range Drop Down ListFor this example, I have created three named ranges, one for each\r\nfile and the data path those files are saved in.\r\nExanple FilesEach cell has been named based on the value in column B of the\r\nworksheet. Spaces have been replaced with underscores where they\r\nexist.\r\nTo create a named range quickly, hit the\r\nCTRL + SHIFT + F3 keys and a dialog box will be shown\r\nasking where the name for the range is. In the example shown, both cells\r\nB2 and C2 have been selected, with cell B2 containing the name to assign\r\nto cell C3\r\nCreate Names from SelectionIf all looks OK in the Create Names from Selection\r\ndialog box, click OK. Selecting cell C3 will shown\r\nData_Path in the Named Range drop down list as shown in the\r\nfirst image above.\r\nExtracting the Named Range\r\nvalue\r\nAlthough I mentioned above that the parameter can be created in one\r\nline of M code, weâ€™ll look at the process of extracting named ranges\r\nfrom a worksheet.\r\n\r\nThe steps in the image above, produce these lines of M code.\r\nlet\r\n    Source = Excel.CurrentWorkbook(),\r\n    #\"Filtered Rows\" = Table.SelectRows(Source, each ([Name] = \"Data_Path\")),\r\n    #\"Removed Other Columns\" = Table.SelectColumns(#\"Filtered Rows\",{\"Content\"}),\r\n    #\"Expanded Content\" = Table.ExpandTableColumn(#\"Removed Other Columns\", \"Content\", {\"Column1\"}, {\"Column1\"}),\r\n    Column1 = #\"Expanded Content\"{0}[Column1]\r\nin\r\n    Column1\r\nWhat does this code do?\r\nThis will list all the named ranges, sheets names and tables.\r\nSource = Excel.CurrentWorkbook()\r\nThis step will filter the list of named ranges to the required\r\nvalue.\r\n#\"Filtered Rows\" = Table.SelectRows(Source, each ([Name] = \"Data_Path\")),\r\nRemoving the Name column from the table shown in the editor window,\r\nby selecting just the Content column.\r\n#\"Removed Other Columns\" = Table.SelectColumns(#\"Filtered Rows\",{\"Content\"})\r\nThis step expands the content in the row for the content column.\r\nClicking in a white space area, next to the word Table will\r\ngive a preview of the value(s) stored in that table.\r\n#\"Expanded Content\" = Table.ExpandTableColumn(#\"Removed Other Columns\", \"Content\", {\"Column1\"}, {\"Column1\"})\r\nTable ContentsColumn1 = #\"Expanded Content\"{0}[Column1]\r\nBy right-clicking in a white space area next to the word\r\nTable and select Drill Down to get to the\r\nvalue of the named range.\r\nA lot of steps to get to one value.\r\nCreate the Power Query\r\nParameter\r\nThe important parts of the M code above, that are needed to use as a\r\none line query are:\r\nExcel.CurrentWorkbook()\r\n\r\n[Name] = \"Data_Path\"\r\n\r\n\"Content\"\r\n\r\n{0}[Column1]\r\n\r\nThese values can be combined into one line:\r\nExcel.CurrentWorkbook(){[Name=\"Data_Path\"]}[Content]{0}[Column1]\r\nThe only part now needed is some meta data that lets Power Query know\r\nthat this query is actually a parameter.\r\nmeta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=false]\r\nCombining these two sets of M code to create the final result.\r\nExcel.CurrentWorkbook(){[Name=\"Data_Path\"]}[Content]{0}[Column1] meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=false]\r\nUsing the Parameter\r\nTo use the parameter in a query, just replace any previously\r\nhard-coded path or file name. As the query contains the meta data values\r\nat the end, the value will also be available in any drop-down lists for\r\nparameters.\r\nUsing a parameterConclusion\r\nThis method of using named ranges from worksheets has reduced\r\ndevelopment time when creating automated excel workbooks.\r\nThere is also a method for storing many parameters in one query, but\r\nthat can be a post for another day.\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-08-15-how-to-parameterise/./CreateParameter1.gif",
    "last_modified": "2022-08-15T18:04:59+01:00",
    "input_file": "how-to-parameterise.knit.md"
  }
]
